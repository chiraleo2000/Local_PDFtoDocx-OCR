# ============================================
# PDF OCR Service — Environment Configuration (Example)
# v0.3.2  |  Optimised for best accuracy
# ============================================
# Copy this file to .env and adjust values for your setup.

# --- Server ---
SERVER_HOST=0.0.0.0
SERVER_PORT=7870
SHARE_GRADIO=false
MAX_FILE_SIZE_MB=200

# --- OCR Engines ---
# Primary: easyocr  — best accuracy for Thai + English mixed text
# Fallback: paddleocr — different engine so it actually helps when primary fails
# Cascade order: EasyOCR -> Thai-TrOCR -> PaddleOCR -> Tesseract
OCR_ENGINE=easyocr
OCR_FALLBACK=paddleocr

# Thai TrOCR — fine-tuned transformer for Thai characters (most accurate Thai OCR)
# Set to 1 to skip pre-loading (saves startup time but slower on first use)
DISABLE_TROCR_PRELOAD=0

# --- GPU ---
# Set USE_GPU=true if you have an NVIDIA GPU with CUDA — significantly faster
USE_GPU=false
CUDA_DEVICE=0

# --- Languages ---
# Comma/plus-separated. Supported: eng tha chi_sim chi_tra jpn kor ara
LANGUAGES=tha+eng

# --- Layout Detection (DocLayout-YOLO) ---
# YOLO_CONFIDENCE: 0.25-0.35 recommended — lower = more detections but more noise
#   0.15 is too permissive (false positives crowd out real tables)
#   0.30 is the model default; 0.25 catches slightly more tables without much noise
YOLO_CONFIDENCE=0.25
# YOLO_NMS: IoU threshold for non-maximum suppression — lower = less overlap allowed
YOLO_NMS=0.40

# --- Table Detection & Extraction ---
TABLE_DETECTION=true
# TABLE_ENGINE: paddleocr = PPStructure (best for complex tables, requires paddleocr)
#               opencv    = pure CV grid detection (fast fallback, always available)
# paddleocr automatically falls back to opencv if PPStructure fails
TABLE_ENGINE=paddleocr

# --- Image Extraction ---
IMAGE_EXTRACTION=true
# Minimum pixel area for a detected region to be saved as a figure (filters noise)
IMAGE_MIN_AREA=4000

# --- Quality Preset ---
# accurate = 2.5x DPI render (best OCR quality, ~40% slower than balanced)
# balanced = 2.0x DPI render (good quality, default speed)
# fast     = 1.5x DPI render (quick preview, lower accuracy)
QUALITY_PRESET=accurate

# --- History ---
HISTORY_RETENTION_DAYS=30

# --- Correction & Auto-Retrain ---
CORRECTION_DATA_DIR=./correction_data
RETRAIN_INTERVAL=100
